<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEST END RITUAL</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
    <link rel="stylesheet" href="/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Define initGoogle BEFORE Google Maps script loads -->
    <script>
        // Define initGoogle globally so Google Maps can call it
        window.initGoogle = function initGoogle(force) {
            console.log('[initGoogle] Called by Google Maps, delegating to full implementation...');
            // The full implementation will be available when script.js loads
            if (typeof window._initGoogleFull === 'function') {
                return window._initGoogleFull(force);
            }
            // If script.js hasn't loaded yet, wait for it
            const checkInterval = setInterval(() => {
                if (typeof window._initGoogleFull === 'function') {
                    clearInterval(checkInterval);
                    window._initGoogleFull(force);
                }
            }, 50);
            // Stop checking after 5 seconds
            setTimeout(() => clearInterval(checkInterval), 5000);
        };
    </script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXUl1ALMadTgG50eu0cM-A7wMbaEj2Uc0&libraries=places&loading=async&callback=initGoogle"
      async
      defer
    ></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">WER</div>
            <div class="nav-right">
                <div class="cart-icon" id="cartIcon">
                    <span class="cart-count">0</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">
                <span class="line">WEST END</span>
                <span class="line">RITUAL</span>
            </h1>
            <p class="hero-subtitle">TORONTO</p>
        </div>
        <div class="scroll-indicator">
            <span>SCROLL</span>
            <div class="scroll-line"></div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products">
        <div class="products-container">
            <div class="products-header">
                <h2 class="section-number">01</h2>
                <h2 class="section-title">COLLECTION</h2>
            </div>
            <div class="products-grid" id="productsGrid">
                <div class="loading-state">LOADING...</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-left">
                <p>Â© 2025 1001206169 ONTARIO CORP.</p>
            </div>
            <div class="footer-right">
                <a href="#" class="footer-link" id="contactLink">CONTACT</a>
                <a href="returns.html" class="footer-link">RETURNS</a>
                <a href="terms.html" class="footer-link">TERMS</a>
                <a href="privacy.html" class="footer-link">PRIVACY</a>
            </div>
        </div>
    </footer>

    <!-- Product Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <div class="modal-body">
                <div class="modal-image" id="modalImage">
                    <div class="product-placeholder large">01</div>
                </div>
                <div class="modal-info">
                    <h2 class="modal-title" id="modalTitle">KENSINGTON</h2>
                    <p class="modal-price" id="modalPrice">$85</p>
                    <div class="modal-options">
                        <div class="size-selector">
                            <label>SIZE</label>
                            <div class="sizes" id="sizeSelector">
                                <!-- Sizes will be dynamically loaded -->
                            </div>
                        </div>
                    </div>
                    <button class="modal-add-cart" id="addToCartBtn">ADD TO CART</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Overlay -->
    <div class="cart-overlay" id="cartOverlay"></div>
    
    <!-- Contact Modal -->
    <div class="modal" id="contactModal">
        <div class="modal-content">
            <button class="modal-close" id="contactModalClose">&times;</button>
            <div class="modal-body" style="grid-template-columns: 1fr;">
                <div>
                    <h2 class="modal-title">CONTACT US</h2>
                    <form id="contactForm" action="https://formspree.io/f/xovglekz" method="POST" style="margin-top: 30px;">
                        <input type="text" name="name" id="contactName" placeholder="Name" required style="width: 100%; margin-bottom: 15px; padding: 12px; background: transparent; border: 1px solid var(--border); color: var(--text-primary); font-family: 'Inter', sans-serif; font-size: 14px;">
                        <input type="email" name="email" id="contactEmail" placeholder="Email" required style="width: 100%; margin-bottom: 15px; padding: 12px; background: transparent; border: 1px solid var(--border); color: var(--text-primary); font-family: 'Inter', sans-serif; font-size: 14px;">
                        <textarea name="message" id="contactMessage" placeholder="Message" required rows="6" style="width: 100%; margin-bottom: 20px; padding: 12px; background: transparent; border: 1px solid var(--border); color: var(--text-primary); font-family: 'Inter', sans-serif; font-size: 14px; resize: vertical;"></textarea>
                        <button type="submit" class="modal-add-cart" style="width: 100%;">SEND MESSAGE</button>
                    </form>
                    <div id="contactMessageStatus" style="margin-top: 20px; font-size: 14px; color: var(--text-secondary); display: none;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h2>SHOPPING CART</h2>
            <button class="cart-close" id="cartClose">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="cart-empty">Your cart is empty</div>
        </div>
        
        <!-- Shipping Address Form -->
        <div class="cart-shipping" id="cartShipping" style="display: none;">
            <h3>SHIPPING ADDRESS</h3>
            <form id="shippingForm">
                <select id="shippingCountry" required>
                    <option value="">Select Country</option>
                    <option value="CA">Canada</option>
                    <option value="US">United States</option>
                </select>
                <input type="text" id="shippingName" placeholder="Full Name" required>
                <gmp-place-autocomplete
                    id="address-input"
                    placeholder="Address Line 1"
                    requested-result-types="address"
                    region="CA"
                    component-restrictions='{"country":["ca","us"]}'
                ></gmp-place-autocomplete>
                <input type="text" id="shippingAddress2" placeholder="Address Line 2 (optional)">
                <div class="shipping-row">
                    <input type="text" id="city" placeholder="City" required>
                    <select id="province" required disabled>
                        <option value="">Select Country First</option>
                    </select>
                </div>
                <div class="shipping-row">
                    <input type="text" id="postal" placeholder="ZIP/Postal Code" required>
                </div>
                <button type="button" id="calculateShippingBtn" class="cart-shipping-btn">CALCULATE SHIPPING</button>
            </form>
            <div id="shippingInfo" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                <div class="shipping-rate">
                    <span id="shippingMethod"></span>
                    <span id="shippingCost"></span>
                </div>
                <div class="shipping-estimate" id="shippingEstimate"></div>
            </div>
        </div>
        
        <div class="cart-footer">
            <div class="cart-total" id="cartTotal">
                <div>TOTAL</div>
                <div>$0.00</div>
            </div>
            <button class="cart-proceed-shipping" id="proceedToShippingBtn" style="display: none;">PROCEED TO SHIPPING</button>
            <button class="cart-checkout" id="checkoutBtn" disabled>CHECKOUT</button>
        </div>
    </div>

    <script src="https://js.stripe.com/v3/"></script>
    <script src="/script.js?v=3" defer></script>
    <noscript>
        <style>
            .products-grid { display: block !important; }
            .loading-state { display: block !important; }
        </style>
    </noscript>
</body>
</html>
